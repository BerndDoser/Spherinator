seed_everything: 42

model:
  class_path: models.RotationalVariationalAutoencoder
  init_args:
    h_dim: 256
    z_dim: 3
    distribution: "vmf"
    image_size: 91
    rotations: 36
    beta: 1.0

data:
  class_path: data.ShapesDataModule
  init_args:
    data_directory: /hits/basement/its/doserbd/projects/data/machine-learning/pink/shapes/
    shuffle: True
    image_size: 91
    batch_size: 32
    num_workers: 4

optimizer:
  class_path: torch.optim.Adam
  init_args:
    lr: 0.001

lr_scheduler:
  class_path: lightning.pytorch.cli.ReduceLROnPlateau
  init_args:
    mode: min
    factor: 0.1
    patience: 5
    cooldown: 5
    min_lr: 1.e-5
    monitor: train_loss
    verbose: True

trainer:
  max_epochs: -1
  accelerator: gpu
  devices: 1
  precision: 32
  logger:
    class_path: lightning.pytorch.loggers.WandbLogger
    init_args:
      project: spherinator
      name: shapes-svae
      log_model: True
  callbacks:
    - class_path: lightning.pytorch.callbacks.ModelCheckpoint
      init_args:
        monitor: train_loss
        filename: "{epoch}-{train_loss:.2f}"
        save_top_k: 1
        mode: min
        every_n_epochs: 1
