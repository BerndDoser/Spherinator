seed_everything: 42

model:
  class_path: spherinator.models.VariationalAutoencoder
  init_args:
    encoder:
      class_path: spherinator.models.ConvolutionalEncoder1D
      init_args:
        input_dim: 344
        output_dim: 256
    decoder:
      class_path: spherinator.models.ConvolutionalDecoder1D
      init_args:
        input_dim: 256
        output_dim: 344
    h_dim: 256
    z_dim: 3
    beta: 1.0e-3

data:
  class_path: spherinator.data.ParquetDataModule
  init_args:
    data_directory: /home/doserbd/data/gaia/xp_sampled_mean_spectrum/parquet
    data_column: flux
    batch_size: 64
    shuffle: True
    num_workers: 4

optimizer:
  class_path: torch.optim.Adam
  init_args:
    lr: 0.001

lr_scheduler:
  class_path: lightning.pytorch.cli.ReduceLROnPlateau
  init_args:
    mode: min
    factor: 0.1
    patience: 5
    cooldown: 5
    min_lr: 1.e-5
    monitor: train_loss
    verbose: True

trainer:
  max_epochs: 100
  accelerator: gpu
  devices: 1
  precision: 32

  logger:
    class_path: lightning.pytorch.loggers.WandbLogger
    init_args:
      project: gaia
      log_model: True
      entity: ain-space
      tags:
        - subset1
