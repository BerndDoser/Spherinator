seed_everything: 42
#ckpt_path: spherinator/hymgr1mo/checkpoints/epoch=41-step=4200.ckpt

model:
  class_path: spherinator.models.EmbeddingDecoder
  init_args:
    decoder:
      class_path: spherinator.models.ConvolutionalDecoder2
      init_args:
        latent_dim: 1024
    z_dim: 1024
    num_embeddings: 100000
    image_size: 363
    rotations: 1

data:
  class_path: spherinator.data.IllustrisSdssDataModule
  init_args:
    data_directories:
      - /local_data/AIN/SKIRT_synthetic_images/TNG100/sdss/snapnum_099/data/
      - /local_data/AIN/SKIRT_synthetic_images/TNG100/sdss/snapnum_095/data/
      - /local_data/AIN/SKIRT_synthetic_images/TNG50/sdss/snapnum_099/data/
      - /local_data/AIN/SKIRT_synthetic_images/TNG50/sdss/snapnum_095/data/
      - /local_data/AIN/SKIRT_synthetic_images/Illustris/sdss/snapnum_135/data/
      - /local_data/AIN/SKIRT_synthetic_images/Illustris/sdss/snapnum_131/data/
    extension: fits
    minsize: 100
    batch_size: 512
    shuffle: True
    num_workers: 16

optimizer:
  class_path: torch.optim.Adam
  init_args:
    lr: 1.e-3

lr_scheduler:
  class_path: lightning.pytorch.cli.ReduceLROnPlateau
  init_args:
    mode: min
    factor: 0.1
    patience: 5
    cooldown: 5
    min_lr: 1.e-6
    monitor: train_loss
    verbose: True

trainer:
  max_epochs: -1
  accelerator: gpu
  devices: [1]
  precision: 32
  callbacks:
    - class_path: spherinator.callbacks.LogReconstructionCallback
      init_args:
        samples: [644, 3244, 5083, 11682, 13635, 19467, 26909, 27130]
  logger:
    class_path: lightning.pytorch.loggers.WandbLogger
    init_args:
      project: spherinator
      log_model: True
      entity: ain-space
      tags:
        - embedding
        - cnn2
